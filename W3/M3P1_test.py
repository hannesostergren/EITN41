import base64 

# we run the 
# openssl asn1parse -in secret_key.pem
# And pastes the values given


version = int("00", 16)
public_exp = int("010001", 16)
private_exp = int("30B5BD48046B78C052AD4F4C94EB4F3B5CD9021EB44DC92EE1D4A004A1FAC2A53A0A8FE0F00F296130CE1720FC95FFF88458C06FAB850AF5F42DFB38CB77B3421D52779ACAE522BB3FA53A27862823272C8F4DE3B0C8179E065C8C21C051C27CAEABFD1A88277005BE7132342A1AD276EEEE9B89F837C88951F770BEB2A20021", 16)
p1 = int("DDDCFD3727A4144C002998AF1A8BD517D3097E5EA7C5FA72D18EF0DD16B529D4974B340FAE3AD5750DFC98650515C79F5A23171BCB800DD446ADB6659370F6BD", 16)
p2 = int("CF10AEE4C7CB317FB5A28B16E8C778AB7C265D87146A06EEF6A7EE8AC87A3BB0789ED3776E48B7A1E6D7ECCE1766F96EC35E2ABFB8EB0644DFD93A88FD5C5DD9", 16)
exp1 = int("B9F8DF0C979EF3208DD650551F246D782DFF3C3D6DD7074BAD9B6B0D78565D7D0561157FBB6537BE89FDDD647871BC46381147F2958F7E881CC2CA2CB4FDB0E5", 16)
exp2 = int("0344561E11F0E8C5050E9D772D11089C5C0716EEACA9C796399A08AF73DE49D6CCF06491BBD1B5E3FE0A66181252739905C8149095D04F7702B920AD4CA20A71", 16)
coeff = int("3327C2872FEC4716ABC9C0E34B5FEC17D40E375783C6D0AFBFFA2ED94C4255B404FFDC4CCC7B3B65AD1EFEA5F2A002F99C3D2CB515595145DF0BFCBDB92E205F",16)
mod = p1*p2

new_key = ""
new_key += "asn1=SEQUENCE:RSA_new_key\n\n"
new_key += "[RSA_new_key]\n"
new_key += "version=INTEGER:" + str(version)+ "\n"
new_key += "modulus=INTEGER:" + str(mod) + "\n"
new_key += "publicExponent=INTEGER:" + str(public_exp) + "\n"
new_key += "privateExponent=INTEGER:" + str(private_exp) + "\n"
new_key += "prime1=INTEGER:" + str(p1) + "\n"
new_key += "prime2=INTEGER:" + str(p2) + "\n"
new_key += "exponent1=INTEGER:" + str(exp1) + "\n"
new_key += "exponent2=INTEGER:" + str(exp2) + "\n"
new_key += "coefficient=INTEGER:" + str(coeff) + "\n"
print(new_key)

text_file = open("new_key.txt", "w")

text_file.write(new_key)

text_file.close()
